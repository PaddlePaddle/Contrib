# Paddle Seq2Seq 疫情预测

## 一、模型结构

本模型基于序列到序列的长短期记忆网络，在时间序列上，通过考虑疫源地对相关城市的人流动态，预测各城市疫情爆发的风险。
其中用一个LSTM作为encoder，得到一个基于自疫源地武汉迁入各个城市的动态时间序列向量表示，用另一个LSTM网络作为decoder，从向量中抽取出与之对应的疫情爆发风险的向量表示的时间序列预测结果。
 
## 二、输入输出

1、模型输入

Mobility: 自武汉迁入74个全国主要城市的人数，长度为20天，即(74,20)的矩阵。
注：请将 mock_data 放置在 data 目录下。

2、模型输出
Risk: 预测74个城市未来3天的新增患者数，即(74,3)的矩阵。
预测结果将存放在 ./data/prediction.csv ，其横轴表示城市名，纵轴天数。


#### 使用方式 单次预测 

1. 训练
   python train.py --use_cuda 
   训练和验证时会打印相应的loss日志
2. 预测
   python test.py --cuda 

输出文件在data文件夹下（prediction.csv)

#### 使用方式 累积量预测

1. 训练
   python train_batch.py --use_cuda 
   训练和验证时会打印相应的loss日志
2. 预测
   python test_batch.py --cuda 

输出文件在：output文件夹下

鸣谢与说明

该模型训练与预测所需之用户移动数据由百度地图提供。所有训练与预测过程，均通过百度数邦平台与百度云算力完成。该模型设计由厦门大学独立提供，百度对该模型的预测结果不持立场，对使用该模型预测所造成的任何后果不承担责任。如需要使用百度移动数据与数邦平台请联系：lucliuji（微信）
